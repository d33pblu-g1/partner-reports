<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Database ‚Ä¢ Partner Report</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" href="data:,">
  <meta name="color-scheme" content="dark light">
  <meta name="description" content="Database viewer with CRUD operations">
  <!-- Theme toggle (load first to prevent flash) -->
  <script src="theme-toggle.js"></script>
  <!-- Burger menu with all controls -->
  <script src="burger-menu.js"></script>
  <script src="database-crud.js"></script>
  <script defer src="script.js"></script>
  <style>
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 10px 12px; border-bottom: 1px solid rgba(148,163,184,0.2); text-align: left; }
    th { color: var(--muted); font-weight: 600; }
    .table-wrap { overflow-x: auto; max-height: 400px; overflow-y: auto; }
    .section { margin-bottom: 28px; }
    
    /* Horizontal scrolling containers */
    .horizontal-scroll-container {
      overflow-x: auto;
      overflow-y: hidden;
      white-space: nowrap;
      padding: 16px 0;
      margin: 16px 0;
      border-radius: 8px;
      background: rgba(148,163,184,0.05);
    }
    
    .horizontal-scroll-container::-webkit-scrollbar {
      height: 8px;
    }
    
    .horizontal-scroll-container::-webkit-scrollbar-track {
      background: rgba(148,163,184,0.1);
      border-radius: 4px;
    }
    
    .horizontal-scroll-container::-webkit-scrollbar-thumb {
      background: var(--accent);
      border-radius: 4px;
    }
    
    .horizontal-scroll-container::-webkit-scrollbar-thumb:hover {
      background: #0ea5e9;
    }
    
    .scroll-item {
      display: inline-block;
      vertical-align: top;
      white-space: normal;
      margin-right: 16px;
      min-width: 300px;
      max-width: 400px;
    }
    
    .scroll-item:last-child {
      margin-right: 0;
    }
    
    /* Section headers */
    .section-header {
      background: var(--panel);
      border: 1px solid rgba(148,163,184,0.2);
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
      text-align: center;
    }
    
    .section-header h2 {
      margin: 0 0 8px 0;
      font-size: 18px;
      font-weight: 700;
    }
    
    .section-header p {
      margin: 0;
      color: var(--muted);
      font-size: 14px;
    }
    
    .tables-section {
      margin-bottom: 32px;
    }
    
    .cubes-section {
      margin-top: 32px;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .scroll-item {
        min-width: 280px;
        max-width: 320px;
      }
    }
  </style>
</head>
<body>
  <div class="layout">
    <aside class="sidebar">
      <div class="brand">
        <div class="logo"></div>
        <h1>Partner Report</h1>
      </div>
      <nav class="side-nav">
        <a href="index.html"><span class="icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M3 10l9-7 9 7v10a2 2 0 0 1-2 2h-4v-6H9v6H5a2 2 0 0 1-2-2V10z" stroke="currentColor" stroke-width="2"/></svg></span><span class="label">Home</span></a>
        <a href="clients.html"><span class="icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M16 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2"/><circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2"/></svg></span><span class="label">Clients</span></a>
        <a href="commissions.html"><span class="icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M4 19h16M4 15l4-4 3 3 6-6" stroke="currentColor" stroke-width="2"/></svg></span><span class="label">Commissions</span></a>
        <a href="client-lifecycle.html"><span class="icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M3 5h18l-7 8v5l-4 2v-7L3 5z" stroke="currentColor" stroke-width="2"/></svg></span><span class="label">Client Lifecycle</span></a>
        <a href="master-partner.html"><span class="icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M12 3l7 4v6c0 5-7 8-7 8s-7-3-7-8V7l7-4z" stroke="currentColor" stroke-width="2"/></svg></span><span class="label">Master Partner</span></a>
        <a href="events.html"><span class="icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><rect x="3" y="5" width="18" height="16" rx="2" stroke="currentColor" stroke-width="2"/><path d="M16 3v4M8 3v4M3 11h18" stroke="currentColor" stroke-width="2"/></svg></span><span class="label">Events</span></a>
        <a href="tiers-badges.html"><span class="icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M12 3l3 6 6 1-4.5 4.4L17 21l-5-2.6L7 21l1.5-6.6L4 10l6-1 2-6z" stroke="currentColor" stroke-width="2"/></svg></span><span class="label">Tiers &amp; Badges</span></a>
        <a href="client-funnel.html"><span class="icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M3 5h18l-7 8v5l-4 2v-7L3 5z" stroke="currentColor" stroke-width="2"/></svg></span><span class="label">Client Funnel</span></a>
        <a href="country-analysis.html"><span class="icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2"/><path d="M3 12h18M12 3a15 15 0 0 1 0 18M12 3a15 15 0 0 0 0 18" stroke="currentColor" stroke-width="2"/></svg></span><span class="label">Country Analysis</span></a>
        <a href="sitemap.html"><span class="icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M10 3h4v4h-4V3zM4 17h4v4H4v-4zm12 0h4v4h-4v-4zM12 7v4m0 0H7v6m5-6h5v6" stroke="currentColor" stroke-width="2"/></svg></span><span class="label">Sitemap</span></a>
        <a href="database.html"><span class="icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none"><ellipse cx="12" cy="5" rx="8" ry="3" stroke="currentColor" stroke-width="2"/><path d="M4 5v6c0 1.7 3.6 3 8 3s8-1.3 8-3V5M4 11v6c0 1.7 3.6 3 8 3s8-1.3 8-3v-6" stroke="currentColor" stroke-width="2"/></svg></span><span class="label">Database</span></a>
      </nav>
    </aside>
    <div class="content">
      <!-- Theme Toggle and Language Selector -->
      <div class="theme-toggle-container" style="display: flex; gap: 12px; align-items: center;">
        <!-- Language Selector -->
        <div class="language-selector-container">
          <select id="language-selector" style="padding: 8px 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--panel); color: var(--text); font-size: 14px;">
            <option value="en">üá∫üá∏ English</option>
            <option value="el">üá¨üá∑ ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨</option>
          </select>
        </div>
        
        <!-- Theme Toggle -->
        <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
          <svg class="sun-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"/>
            <line x1="12" y1="1" x2="12" y2="3"/>
            <line x1="12" y1="21" x2="12" y2="23"/>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
            <line x1="1" y1="12" x2="3" y2="12"/>
            <line x1="21" y1="12" x2="23" y2="12"/>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
          </svg>
          <svg class="moon-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
          </svg>
        </button>
      </div>

      <div class="container">
        <main class="panel">
          <h2 class="page-title" data-translate="database.title">Database</h2>
          <p class="page-subtitle" data-translate="database.subtitle">MySQL database tables with CRUD operations</p>

          <!-- Database Tables Section -->
          <div class="card" style="margin-bottom: 24px;">
            <h3 style="margin-top: 0; margin-bottom: 16px;" data-translate="database.tables.title">üíæ Database Tables</h3>
            <div style="display: flex; gap: 16px; align-items: center; margin-bottom: 16px;">
              <label for="tableSelect" style="font-weight: 600; color: var(--text);" data-translate="database.tables.select">Select Table:</label>
              <select id="tableSelect" style="flex: 1; padding: 8px 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--panel); color: var(--text);">
                <option value="" data-translate="database.tables.loading">Loading tables...</option>
              </select>
            </div>
            <div id="tableContent" style="min-height: 400px; border: 1px solid var(--border); border-radius: 8px; padding: 16px; background: rgba(148,163,184,0.05);">
              <div style="text-align: center; padding: 40px; color: var(--muted);" data-translate="database.tables.select_prompt">
                Select a table to view its contents
              </div>
            </div>
          </div>

          <!-- Data Cubes Section -->
          <div class="card">
            <h3 style="margin-top: 0; margin-bottom: 16px;" data-translate="database.cubes.title">üìä Data Cubes</h3>
            <div style="display: flex; gap: 16px; align-items: center; margin-bottom: 16px;">
              <label for="cubeSelect" style="font-weight: 600; color: var(--text);" data-translate="database.cubes.select">Select Cube:</label>
              <select id="cubeSelect" style="flex: 1; padding: 8px 12px; border: 1px solid var(--border); border-radius: 8px; background: var(--panel); color: var(--text);">
                <option value="" data-translate="database.cubes.loading">Loading cubes...</option>
              </select>
            </div>
            <div id="cubeContent" style="min-height: 400px; border: 1px solid var(--border); border-radius: 8px; padding: 16px; background: rgba(148,163,184,0.05);">
              <div style="text-align: center; padding: 40px; color: var(--muted);" data-translate="database.cubes.select_prompt">
                Select a cube to view its contents
              </div>
            </div>
          </div>

          <div id="content" style="display: none;"></div>

          <div class="footer" data-translate="database.version">v1.015 - partner report</div>
        </main>
      </div>
    </div>
  </div>

  <script>
    // Translation system
    const translations = {
      en: {
        'database.title': 'Database',
        'database.subtitle': 'MySQL database tables with CRUD operations',
        'database.tables.title': 'üíæ Database Tables',
        'database.tables.select': 'Select Table:',
        'database.tables.loading': 'Loading tables...',
        'database.tables.select_prompt': 'Select a table to view its contents',
        'database.cubes.title': 'üìä Data Cubes',
        'database.cubes.select': 'Select Cube:',
        'database.cubes.loading': 'Loading cubes...',
        'database.cubes.select_prompt': 'Select a cube to view its contents',
        'database.version': 'v1.015 - partner report',
        'database.tables.names': {
          'partners': 'Partners',
          'clients': 'Clients',
          'trades': 'Trades',
          'deposits': 'Deposits',
          'badges': 'Badges',
          'partner_badges': 'Partner Badges',
          'partner_tiers': 'Partner Tiers'
        },
        'database.cubes.names': {
          'cube_partner_dashboard': 'Dashboard',
          'cube_daily_commissions_plan': 'Daily Commissions (Plan)',
          'cube_daily_commissions_platform': 'Daily Commissions (Platform)',
          'cube_commissions_product': 'Commissions by Product',
          'cube_commissions_symbol': 'Commissions by Symbol',
          'cube_daily_signups': 'Daily Signups',
          'cube_daily_funding': 'Daily Deposits/Withdrawals',
          'cube_client_tiers': 'Client Tiers',
          'cube_client_demographics': 'Demographics',
          'cube_country_performance': 'Country Performance',
          'cube_product_volume': 'Product Volume',
          'cube_daily_trends': 'Daily Trends',
          'cube_badge_progress': 'Badge Progress',
          'cube_partner_countries': 'Partner Countries'
        },
        'database.messages': {
          'no_data': 'No data available',
          'records': 'records',
          'add_record': '‚ûï Add Record',
          'error_loading': 'Error loading tables',
          'error_loading_cubes': 'Error loading cubes'
        }
      },
      el: {
        'database.title': 'ŒíŒ¨œÉŒ∑ ŒîŒµŒ¥ŒøŒºŒ≠ŒΩœâŒΩ',
        'database.subtitle': 'Œ†ŒØŒΩŒ±Œ∫ŒµœÇ Œ≤Œ¨œÉŒ∑œÇ Œ¥ŒµŒ¥ŒøŒºŒ≠ŒΩœâŒΩ MySQL ŒºŒµ ŒªŒµŒπœÑŒøœÖœÅŒ≥ŒØŒµœÇ CRUD',
        'database.tables.title': 'üíæ Œ†ŒØŒΩŒ±Œ∫ŒµœÇ ŒíŒ¨œÉŒ∑œÇ ŒîŒµŒ¥ŒøŒºŒ≠ŒΩœâŒΩ',
        'database.tables.select': 'ŒïœÄŒπŒªŒøŒ≥ŒÆ Œ†ŒØŒΩŒ±Œ∫Œ±:',
        'database.tables.loading': 'Œ¶œåœÅœÑœâœÉŒ∑ œÄŒπŒΩŒ¨Œ∫œâŒΩ...',
        'database.tables.select_prompt': 'ŒïœÄŒπŒªŒ≠ŒæœÑŒµ Œ≠ŒΩŒ±ŒΩ œÄŒØŒΩŒ±Œ∫Œ± Œ≥ŒπŒ± ŒΩŒ± Œ¥ŒµŒØœÑŒµ œÑŒ± œÄŒµœÅŒπŒµœáœåŒºŒµŒΩŒ¨ œÑŒøœÖ',
        'database.cubes.title': 'üìä ŒöœçŒ≤ŒøŒπ ŒîŒµŒ¥ŒøŒºŒ≠ŒΩœâŒΩ',
        'database.cubes.select': 'ŒïœÄŒπŒªŒøŒ≥ŒÆ ŒöœçŒ≤ŒøœÖ:',
        'database.cubes.loading': 'Œ¶œåœÅœÑœâœÉŒ∑ Œ∫œçŒ≤œâŒΩ...',
        'database.cubes.select_prompt': 'ŒïœÄŒπŒªŒ≠ŒæœÑŒµ Œ≠ŒΩŒ±ŒΩ Œ∫œçŒ≤Œø Œ≥ŒπŒ± ŒΩŒ± Œ¥ŒµŒØœÑŒµ œÑŒ± œÄŒµœÅŒπŒµœáœåŒºŒµŒΩŒ¨ œÑŒøœÖ',
        'database.version': 'v1.015 - Œ±ŒΩŒ±œÜŒøœÅŒ¨ œÉœÖŒΩŒµœÅŒ≥Œ±œÑœéŒΩ',
        'database.tables.names': {
          'partners': 'Œ£œÖŒΩŒµœÅŒ≥Œ¨œÑŒµœÇ',
          'clients': 'Œ†ŒµŒªŒ¨œÑŒµœÇ',
          'trades': 'Œ£œÖŒΩŒ±ŒªŒªŒ±Œ≥Œ≠œÇ',
          'deposits': 'ŒöŒ±œÑŒ±Œ∏Œ≠œÉŒµŒπœÇ',
          'badges': 'Œ£ŒÆŒºŒ±œÑŒ±',
          'partner_badges': 'Œ£ŒÆŒºŒ±œÑŒ± Œ£œÖŒΩŒµœÅŒ≥Œ±œÑœéŒΩ',
          'partner_tiers': 'ŒïœÄŒØœÄŒµŒ¥Œ± Œ£œÖŒΩŒµœÅŒ≥Œ±œÑœéŒΩ'
        },
        'database.cubes.names': {
          'cube_partner_dashboard': 'Œ†ŒØŒΩŒ±Œ∫Œ±œÇ ŒïŒªŒ≠Œ≥œáŒøœÖ',
          'cube_daily_commissions_plan': 'ŒóŒºŒµœÅŒÆœÉŒπŒµœÇ Œ†œÅŒøŒºŒÆŒ∏ŒµŒπŒµœÇ (Œ£œáŒ≠Œ¥ŒπŒø)',
          'cube_daily_commissions_platform': 'ŒóŒºŒµœÅŒÆœÉŒπŒµœÇ Œ†œÅŒøŒºŒÆŒ∏ŒµŒπŒµœÇ (Œ†ŒªŒ±œÑœÜœåœÅŒºŒ±)',
          'cube_commissions_product': 'Œ†œÅŒøŒºŒÆŒ∏ŒµŒπŒµœÇ Œ∫Œ±œÑŒ¨ Œ†œÅŒøœäœåŒΩ',
          'cube_commissions_symbol': 'Œ†œÅŒøŒºŒÆŒ∏ŒµŒπŒµœÇ Œ∫Œ±œÑŒ¨ Œ£œçŒºŒ≤ŒøŒªŒø',
          'cube_daily_signups': 'ŒóŒºŒµœÅŒÆœÉŒπŒµœÇ ŒïŒ≥Œ≥œÅŒ±œÜŒ≠œÇ',
          'cube_daily_funding': 'ŒóŒºŒµœÅŒÆœÉŒπŒµœÇ ŒöŒ±œÑŒ±Œ∏Œ≠œÉŒµŒπœÇ/ŒëŒΩŒ±ŒªŒÆœàŒµŒπœÇ',
          'cube_client_tiers': 'ŒïœÄŒØœÄŒµŒ¥Œ± Œ†ŒµŒªŒ±œÑœéŒΩ',
          'cube_client_demographics': 'ŒîŒ∑ŒºŒøŒ≥œÅŒ±œÜŒπŒ∫Œ¨',
          'cube_country_performance': 'ŒëœÄœåŒ¥ŒøœÉŒ∑ ŒßœéœÅŒ±œÇ',
          'cube_product_volume': 'ŒåŒ≥Œ∫ŒøœÇ Œ†œÅŒøœäœåŒΩœÑŒøœÇ',
          'cube_daily_trends': 'ŒóŒºŒµœÅŒÆœÉŒπŒµœÇ Œ§Œ¨œÉŒµŒπœÇ',
          'cube_badge_progress': 'Œ†œÅœåŒøŒ¥ŒøœÇ Œ£Œ∑ŒºŒ¨œÑœâŒΩ',
          'cube_partner_countries': 'ŒßœéœÅŒµœÇ Œ£œÖŒΩŒµœÅŒ≥Œ±œÑœéŒΩ'
        },
        'database.messages': {
          'no_data': 'ŒîŒµŒΩ œÖœÄŒ¨œÅœáŒøœÖŒΩ Œ¥ŒπŒ±Œ∏Œ≠œÉŒπŒºŒ± Œ¥ŒµŒ¥ŒøŒºŒ≠ŒΩŒ±',
          'records': 'ŒµŒ≥Œ≥œÅŒ±œÜŒ≠œÇ',
          'add_record': '‚ûï Œ†œÅŒøœÉŒ∏ŒÆŒ∫Œ∑ ŒïŒ≥Œ≥œÅŒ±œÜŒÆœÇ',
          'error_loading': 'Œ£œÜŒ¨ŒªŒºŒ± œÜœåœÅœÑœâœÉŒ∑œÇ œÄŒπŒΩŒ¨Œ∫œâŒΩ',
          'error_loading_cubes': 'Œ£œÜŒ¨ŒªŒºŒ± œÜœåœÅœÑœâœÉŒ∑œÇ Œ∫œçŒ≤œâŒΩ'
        }
      }
    };

    // Current language
    let currentLanguage = localStorage.getItem('language') || 'en';

    // Translation functions
    function translateElement(element) {
      const key = element.getAttribute('data-translate');
      if (key && translations[currentLanguage] && translations[currentLanguage][key]) {
        element.textContent = translations[currentLanguage][key];
      }
    }

    function translatePage() {
      document.querySelectorAll('[data-translate]').forEach(translateElement);
    }

    function getTranslation(key) {
      return translations[currentLanguage] && translations[currentLanguage][key] 
        ? translations[currentLanguage][key] 
        : key;
    }

    // Language selector functionality
    function initLanguageSelector() {
      const languageSelector = document.getElementById('language-selector');
      if (languageSelector) {
        languageSelector.value = currentLanguage;
        languageSelector.addEventListener('change', function() {
          currentLanguage = this.value;
          localStorage.setItem('language', currentLanguage);
          translatePage();
          updateTableAndCubeNames();
        });
      }
    }

    // Global variables to store database data
    var databaseData = {};
    var tableSections = [
      { key: 'partners', title: 'Partners' },
      { key: 'clients', title: 'Clients' },
      { key: 'trades', title: 'Trades' },
      { key: 'deposits', title: 'Deposits' },
      { key: 'badges', title: 'Badges' },
      { key: 'partner_badges', title: 'Partner Badges' },
      { key: 'partner_tiers', title: 'Partner Tiers' }
    ];
    
    var cubeSections = [
      { key: 'cube_partner_dashboard', title: 'Dashboard' },
      { key: 'cube_daily_commissions_plan', title: 'Daily Commissions (Plan)' },
      { key: 'cube_daily_commissions_platform', title: 'Daily Commissions (Platform)' },
      { key: 'cube_commissions_product', title: 'Commissions by Product' },
      { key: 'cube_commissions_symbol', title: 'Commissions by Symbol' },
      { key: 'cube_daily_signups', title: 'Daily Signups' },
      { key: 'cube_daily_funding', title: 'Daily Deposits/Withdrawals' },
      { key: 'cube_client_tiers', title: 'Client Tiers' },
      { key: 'cube_client_demographics', title: 'Demographics' },
      { key: 'cube_country_performance', title: 'Country Performance' },
      { key: 'cube_product_volume', title: 'Product Volume' },
      { key: 'cube_daily_trends', title: 'Daily Trends' },
      { key: 'cube_badge_progress', title: 'Badge Progress' },
      { key: 'cube_partner_countries', title: 'Partner Countries' }
    ];

    function updateTableAndCubeNames() {
      // Update table section names
      tableSections.forEach(function(section) {
        const translatedName = getTranslation('database.tables.names.' + section.key);
        if (translatedName !== 'database.tables.names.' + section.key) {
          section.title = translatedName;
        }
      });

      // Update cube section names
      cubeSections.forEach(function(section) {
        const translatedName = getTranslation('database.cubes.names.' + section.key);
        if (translatedName !== 'database.cubes.names.' + section.key) {
          section.title = translatedName;
        }
      });

      // Repopulate dropdowns if data is already loaded
      if (Object.keys(databaseData).length > 0) {
        populateTableSelect();
        populateCubeSelect();
      }
    }

    function createTableFromArray(arr, tableName) {
      if (!Array.isArray(arr) || arr.length === 0) {
        var empty = document.createElement('div');
        empty.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--muted);">' + getTranslation('database.messages.no_data') + '</div>';
        return empty;
      }
      
      var columns = Array.from(new Set(arr.flatMap(function (row) { return Object.keys(row); })));
      var wrap = document.createElement('div');
      wrap.className = 'table-wrap';
      
      // Add record count header
      var header = document.createElement('div');
      header.style.marginBottom = '16px';
      header.style.padding = '12px';
      header.style.background = 'var(--panel)';
      header.style.borderRadius = '8px';
      header.style.border = '1px solid var(--border)';
      header.innerHTML = '<strong>' + arr.length + ' ' + getTranslation('database.messages.records') + '</strong> ' + (currentLanguage === 'el' ? 'œÉœÑŒøŒΩ' : 'in') + ' ' + tableName;
      wrap.appendChild(header);
      
      var table = document.createElement('table');
      table.style.width = '100%';
      table.style.borderCollapse = 'collapse';
      
      var thead = document.createElement('thead');
      var trHead = document.createElement('tr');
      columns.forEach(function (col) {
        var th = document.createElement('th'); 
        th.textContent = col; 
        th.style.padding = '10px 12px';
        th.style.borderBottom = '1px solid var(--border)';
        th.style.textAlign = 'left';
        th.style.color = 'var(--muted)';
        th.style.fontWeight = '600';
        trHead.appendChild(th);
      });
      thead.appendChild(trHead);
      
      var tbody = document.createElement('tbody');
      arr.forEach(function (row) {
        var tr = document.createElement('tr');
        columns.forEach(function (col) {
          var td = document.createElement('td');
          var v = row[col];
          td.textContent = (v == null) ? '' : (typeof v === 'object' ? JSON.stringify(v) : v);
          td.style.padding = '10px 12px';
          td.style.borderBottom = '1px solid rgba(148,163,184,0.2)';
          td.style.textAlign = 'left';
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });
      
      table.appendChild(thead);
      table.appendChild(tbody);
      wrap.appendChild(table);
      return wrap;
    }

    function populateTableSelect() {
      var tableSelect = document.getElementById('tableSelect');
      tableSelect.innerHTML = '<option value="">' + (currentLanguage === 'el' ? 'ŒïœÄŒπŒªŒ≠ŒæœÑŒµ œÄŒØŒΩŒ±Œ∫Œ±...' : 'Select a table...') + '</option>';
      
      tableSections.forEach(function(section) {
        var option = document.createElement('option');
        option.value = section.key;
        option.textContent = section.title + ' (' + (databaseData[section.key] ? databaseData[section.key].length : 0) + ' ' + getTranslation('database.messages.records') + ')';
        tableSelect.appendChild(option);
      });
    }

    function populateCubeSelect() {
      var cubeSelect = document.getElementById('cubeSelect');
      cubeSelect.innerHTML = '<option value="">' + (currentLanguage === 'el' ? 'ŒïœÄŒπŒªŒ≠ŒæœÑŒµ Œ∫œçŒ≤Œø...' : 'Select a cube...') + '</option>';
      
      cubeSections.forEach(function(section) {
        var option = document.createElement('option');
        option.value = section.key;
        option.textContent = section.title + ' (' + (databaseData[section.key] ? databaseData[section.key].length : 0) + ' ' + getTranslation('database.messages.records') + ')';
        cubeSelect.appendChild(option);
      });
    }

    function displayTable(tableKey) {
      var tableContent = document.getElementById('tableContent');
      var section = tableSections.find(s => s.key === tableKey);
      
      if (!section || !databaseData[tableKey]) {
        tableContent.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--muted);">' + getTranslation('database.messages.no_data') + ' ' + (currentLanguage === 'el' ? 'Œ≥ŒπŒ±' : 'for') + ' ' + (section ? section.title : tableKey) + '</div>';
        return;
      }
      
      tableContent.innerHTML = '';
      
      // Add CRUD buttons if available
      if (window.DatabaseCRUD) {
        var crudButtons = document.createElement('div');
        crudButtons.style.marginBottom = '16px';
        crudButtons.style.display = 'flex';
        crudButtons.style.gap = '8px';
        
        var addBtn = document.createElement('button');
        addBtn.className = 'btn-primary';
        addBtn.innerHTML = getTranslation('database.messages.add_record');
        addBtn.style.padding = '8px 16px';
        addBtn.onclick = function() {
          window.DatabaseCRUD.showAddModal(tableKey);
        };
        crudButtons.appendChild(addBtn);
        
        tableContent.appendChild(crudButtons);
      }
      
      // Add the table
      if (window.DatabaseCRUD) {
        tableContent.appendChild(window.DatabaseCRUD.createTable(databaseData[tableKey], tableKey));
      } else {
        tableContent.appendChild(createTableFromArray(databaseData[tableKey], section.title));
      }
    }

    function displayCube(cubeKey) {
      var cubeContent = document.getElementById('cubeContent');
      var section = cubeSections.find(s => s.key === cubeKey);
      
      if (!section || !databaseData[cubeKey]) {
        cubeContent.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--muted);">' + getTranslation('database.messages.no_data') + ' ' + (currentLanguage === 'el' ? 'Œ≥ŒπŒ±' : 'for') + ' ' + (section ? section.title : cubeKey) + '</div>';
        return;
      }
      
      cubeContent.innerHTML = '';
      cubeContent.appendChild(createTableFromArray(databaseData[cubeKey], section.title));
    }

    // Function to load database tables
    function loadDatabaseTables(loadAll) {
      var url = 'api/index.php?endpoint=all_tables';
      if (loadAll) {
        url += '&load_all=true';
      }
      
      // Show loading state
      var tableSelect = document.getElementById('tableSelect');
      var cubeSelect = document.getElementById('cubeSelect');
      tableSelect.innerHTML = '<option value="">Loading tables...</option>';
      cubeSelect.innerHTML = '<option value="">Loading cubes...</option>';
      
      fetch(url)
      .then(r => r.json())
      .then(function (response) {
        if (!response.success) {
          throw new Error(response.message || 'Failed to load tables');
        }
        
        databaseData = response.data;
        
        console.log('‚úì Loaded database tables from MySQL:', {
          partners: databaseData.partners ? databaseData.partners.length : 0,
          clients: databaseData.clients ? databaseData.clients.length : 0,
          trades: databaseData.trades ? databaseData.trades.length : 0,
          deposits: databaseData.deposits ? databaseData.deposits.length : 0,
          badges: databaseData.badges ? databaseData.badges.length : 0,
          partner_badges: databaseData.partner_badges ? databaseData.partner_badges.length : 0,
          partner_tiers: databaseData.partner_tiers ? databaseData.partner_tiers.length : 0
        });
        
        // Populate dropdowns
        populateTableSelect();
        populateCubeSelect();
        
        // Add event listeners
        tableSelect.addEventListener('change', function() {
          displayTable(this.value);
        });
        
        cubeSelect.addEventListener('change', function() {
          displayCube(this.value);
        });
        
        // Show metadata info
        var metadata = databaseData._metadata || {};
        if (metadata.has_limits) {
          console.log('‚ö†Ô∏è Showing up to 1,000 records for Trades and Deposits tables');
        } else if (metadata.load_all) {
          console.log('‚úì All records loaded');
        }
      })
      .catch(function (e) {
        var tableSelect = document.getElementById('tableSelect');
        var cubeSelect = document.getElementById('cubeSelect');
        tableSelect.innerHTML = '<option value="">Error loading tables</option>';
        cubeSelect.innerHTML = '<option value="">Error loading cubes</option>';
        
        console.error('Database loading error:', e);
        alert('‚ùå Database Connection Error: ' + String(e));
      });
    }
    
    // Initial load
    loadDatabaseTables(false);
  </script>
</body>
</html>


